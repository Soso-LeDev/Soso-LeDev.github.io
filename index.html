<!DOCTYPE html>
<html lang="fr" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SCP Redux - Portail Officiel</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    /* Reset & fonts */
    body,html {
      margin:0; padding:0; height:100%;
      background: #0a0a0a;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #d0f3d0;
      overflow-x: hidden;
    }
    /* Glassmorphism cards */
    .glass-card {
      background: rgba(20, 25, 20, 0.7);
      backdrop-filter: blur(12px);
      border-radius: 12px;
      border: 1px solid #0f4210;
      box-shadow: 0 0 8px #10b981aa;
      padding: 1.5rem;
    }
    /* Neon text */
    .neon-text {
      color: #10b981;
      text-shadow:
        0 0 5px #10b981,
        0 0 10px #10b981,
        0 0 20px #10b981,
        0 0 40px #0fb05e;
    }
    /* Navbar */
    nav {
      position: fixed;
      top:0; left:0; right:0;
      height: 60px;
      background: rgba(10, 15, 10, 0.9);
      backdrop-filter: saturate(180%) blur(10px);
      display: flex;
      align-items: center;
      padding: 0 2rem;
      z-index: 1000;
      box-shadow: 0 2px 8px #0f4210cc;
    }
    nav a {
      color: #10b981;
      margin-right: 2rem;
      font-weight: 600;
      text-decoration: none;
      transition: color 0.3s;
    }
    nav a:hover, nav a.active {
      color: #75ffc0;
      text-shadow: 0 0 8px #75ffc0;
    }
    main {
      padding: 80px 2rem 2rem;
      max-width: 960px;
      margin: 0 auto;
    }
    /* Sections */
    section {
      margin-bottom: 3rem;
    }
    /* Intro full screen overlay */
    #introOverlay {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: #040804;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      color: #10b981;
      font-size: 3rem;
      font-weight: 900;
      letter-spacing: 0.2em;
      text-shadow:
        0 0 20px #10b981,
        0 0 40px #10b981,
        0 0 80px #0fb05e;
      user-select:none;
    }
    /* Portal animation */
    @keyframes portalPulse {
      0% { text-shadow: 0 0 20px #10b981, 0 0 40px #10b981, 0 0 80px #0fb05e; }
      50% { text-shadow: 0 0 40px #75ffc0, 0 0 80px #75ffc0, 0 0 160px #75ffc0; }
      100% { text-shadow: 0 0 20px #10b981, 0 0 40px #10b981, 0 0 80px #0fb05e; }
    }
    #introOverlay span {
      animation: portalPulse 2.5s ease-in-out infinite;
    }
    /* Chat box styling */
    #chatBox {
      height: 300px;
      overflow-y: auto;
      background: rgba(10, 15, 10, 0.8);
      border-radius: 12px;
      padding: 1rem;
      color: #a0f0a0;
      font-family: monospace;
      font-size: 0.95rem;
      box-shadow: inset 0 0 10px #10b981aa;
    }
    .chat-msg-user {
      background: #0f4210cc;
      margin: 0.3rem 0;
      padding: 0.4rem 0.8rem;
      border-radius: 8px;
      align-self: flex-end;
      max-width: 80%;
    }
    .chat-msg-assistant {
      background: #103a04cc;
      margin: 0.3rem 0;
      padding: 0.4rem 0.8rem;
      border-radius: 8px;
      align-self: flex-start;
      max-width: 80%;
    }
    /* Chat container flex */
    #chatContainer {
      display: flex;
      flex-direction: column;
    }
    /* Chat input & button */
    #chatInputRow {
      margin-top: 0.8rem;
      display: flex;
      gap: 0.6rem;
    }
    #chatInputRow input {
      flex-grow: 1;
      border-radius: 8px;
      border: none;
      padding: 0.6rem 1rem;
      background: #142514;
      color: #a0f0a0;
      font-family: monospace;
      font-size: 1rem;
      outline-offset: 2px;
    }
    #chatInputRow input:focus {
      outline: 2px solid #10b981;
      background: #163018;
    }
    #chatInputRow button {
      background: #10b981;
      border: none;
      border-radius: 8px;
      padding: 0 1.2rem;
      color: #020;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #chatInputRow button:hover {
      background: #75ffc0;
    }
    /* Recruitment form */
    #recruitForm input, #recruitForm select, #recruitForm textarea {
      width: 100%;
      background: #142514;
      border-radius: 8px;
      border: 1px solid #0f4210;
      padding: 0.6rem 1rem;
      color: #a0f0a0;
      font-size: 1rem;
      margin-bottom: 1rem;
      resize: vertical;
      transition: border-color 0.3s;
      font-family: inherit;
    }
    #recruitForm input:focus, #recruitForm select:focus, #recruitForm textarea:focus {
      outline: none;
      border-color: #10b981;
      background: #163018;
    }
    #recruitForm button {
      background: #10b981;
      color: #020;
      font-weight: 700;
      padding: 0.8rem 0;
      border-radius: 8px;
      border: none;
      width: 100%;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    #recruitForm button:hover {
      background: #75ffc0;
    }
    #applyMsg {
      color: #75ffc0;
      font-weight: 600;
      text-align: center;
      display: none;
    }
    /* Docs section */
    #docsSection a {
      color: #10b981;
      text-decoration: underline;
      transition: color 0.3s;
    }
    #docsSection a:hover {
      color: #75ffc0;
    }
    /* Responsive */
    @media (max-width: 640px) {
      main {
        padding: 80px 1rem 1rem;
      }
      nav {
        padding: 0 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- Intro screen -->
  <div id="introOverlay"><span>--- SCP Redux ---</span></div>

  <!-- Navbar -->
  <nav>
    <a href="#accueil" class="active">Accueil</a>
    <a href="#chat">Chat</a>
    <a href="#recrutement">Recrutement</a>
    <a href="#docs">Docs</a>
  </nav>

  <!-- Main container -->
  <main>
    <!-- Accueil -->
    <section id="accueil" class="glass-card">
      <h1 class="text-4xl neon-text mb-4">Bienvenue sur SCP Redux</h1>
      <p>Ce portail officiel est dédié à l'univers SCP, avec un assistant intelligent nommé <strong>Krozen</strong> pour t'aider dans le jeu et le projet.</p>
      <p>Connecte-toi avec Google pour accéder au chat et postuler à l'équipe de développement.</p>

      <!-- Google Sign-In -->
      <div id="google-login" class="mt-6 flex justify-center">
        <div id="g_id_onload"
             data-client_id="623343442822-vg5208651s2f9jfdlr6d65379lehna8b.apps.googleusercontent.com"
             data-callback="onGoogleLogin"
             data-auto_prompt="false"></div>
        <div class="g_id_signin"
             data-type="standard"
             data-size="large"
             data-theme="outline"
             data-text="sign_in_with"
             data-shape="pill"
             data-logo_alignment="left"></div>
      </div>
    </section>

    <!-- Chat -->
    <section id="chat" class="glass-card hidden flex flex-col">
      <h2 class="text-3xl neon-text mb-4">Chat avec Krozen</h2>
      <div id="chatContainer" class="flex flex-col">
        <div id="chatBox" aria-live="polite" role="log" class="mb-3"></div>
        <div id="chatInputRow">
          <input id="chatInput" type="text" placeholder="Pose ta question SCP ou projet..." autocomplete="off" />
          <button aria-label="Envoyer message" onclick="sendChat()">➤</button>
        </div>
      </div>
    </section>

    <!-- Recrutement -->
    <section id="recrutement" class="glass-card hidden">
      <h2 class="text-3xl neon-text mb-4">Recrutement</h2>
      <form id="recruitForm" aria-label="Formulaire de recrutement">
        <input type="text" id="fullName" placeholder="Nom complet" required autocomplete="name" />
        <input type="email" id="emailApply" placeholder="Email" required autocomplete="email" />
        <select id="roleSelect" aria-label="Sélectionner un rôle">
          <option value="dev">Développeur</option>
          <option value="designer">Designer</option>
          <option value="tester">Testeur</option>
          <option value="autre">Autre</option>
        </select>
        <textarea id="motivation" placeholder="Pourquoi souhaites-tu rejoindre ?" rows="4" required></textarea>
        <button type="submit">Envoyer la demande</button>
      </form>
      <div id="applyMsg" role="alert" aria-live="assertive"></div>
    </section>

    <!-- Docs -->
    <section id="docs" class="glass-card">
      <h2 class="text-3xl neon-text mb-4">Documentation</h2>
      <p>Liens utiles :</p>
      <ul>
        <li><a href="https://scpwiki.com" target="_blank" rel="noopener">SCP Wiki</a></li>
        <li><a href="https://krozen.docs" target="_blank" rel="noopener">Documentation Krozen (exemple)</a></li>
        <li><a href="https://github.com/soso-ledev/scp-redux" target="_blank" rel="noopener">Repo GitHub SCP Redux</a></li>
      </ul>
    </section>
  </main>

  <script>
    // Intro overlay hide après 3.5s
    setTimeout(() => {
      document.getElementById('introOverlay').style.display = 'none';
    }, 3500);

    // Navigation active link highlight
    const navLinks = document.querySelectorAll('nav a');
    navLinks.forEach(a => {
      a.addEventListener('click', e => {
        e.preventDefault();
        navLinks.forEach(link => link.classList.remove('active'));
        a.classList.add('active');
        document.querySelector(a.getAttribute('href')).scrollIntoView({behavior: 'smooth'});
      });
    });

    // Google Login
    let googleUser = null;

    function onGoogleLogin(response) {
      try {
        const p = JSON.parse(atob(response.credential.split('.')[1]));
        googleUser = p;

        // Cache zone connexion, affiche chat + recrutement
        document.getElementById('google-login').style.display = 'none';
        document.getElementById('chat').classList.remove('hidden');
        document.getElementById('recrutement').classList.remove('hidden');

        appendChat('[SYSTEM] Bienvenue ' + p.name + ' ! Pose tes questions SCP ou sur le projet.');

      } catch (e) {
        console.error("Erreur parsing Google token:", e);
      }
    }

    // Chat
    const chatBox = document.getElementById('chatBox');
    const chatInput = document.getElementById('chatInput');

    function appendChat(msg, user = false) {
      const div = document.createElement('div');
      div.className = user ? 'chat-msg-user' : 'chat-msg-assistant';
      div.textContent = msg;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function sendChat() {
      const msg = chatInput.value.trim();
      if (!msg) return;
      appendChat(msg, true);
      chatInput.value = '';

      // Simuler réponse IA basique (placeholder)
      setTimeout(() => {
        let response = "Je ne sais pas répondre à ça pour l'instant.";
        // Exemple: réponse spéciale pour scp-173
        if (msg.toLowerCase().includes('scp-173')) {
          response = "SCP-173 est une sculpture animée extrêmement dangereuse, immobilisez-le en le regardant constamment.";
        }
        if (msg.toLowerCase().includes('chef de projet')) {
          response = "Le chef de projet est actuellement Soso, responsable de la coordination du projet SCP Redux.";
        }
        appendChat(response);
      }, 1000);
    }

    // Recrutement form
    const form = document.getElementById('recruitForm');
    const applyMsg = document.getElementById('applyMsg');

    form.addEventListener('submit', e => {
      e.preventDefault();
      if (!googleUser) {
        alert("Connectez-vous via Google avant de postuler.");
        return;
      }

      // Collect data
      const data = {
        name: form.fullName.value.trim(),
        email: form.emailApply.value.trim(),
        role: form.roleSelect.value,
        motivation: form.motivation.value.trim(),
        userId: googleUser.sub
      };

      // Ici tu peux envoyer ces données à une API, backend, ou stockage
      // Exemple fake:
      setTimeout(() => {
        applyMsg.textContent = "Merci " + data.name + ", ta candidature a été envoyée !";
        applyMsg.style.display = 'block';
        form.reset();
      }, 800);
    });
  </script>
</body>
</html>
