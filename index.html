<!DOCTYPE html>
<html lang="fr">

<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>Chat avec Scout</title>

Â  <!-- Marked.js pour conversion Markdown â†’ HTML -->
Â  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

Â  <style>
Â  Â  * { box-sizing: border-box; }
Â  Â  body {
Â  Â  Â  margin: 0;
Â  Â  Â  font-family: 'Segoe UI', sans-serif;
Â  Â  Â  background-color: #ece5dd;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  height: 100vh;
Â  Â  }
Â  Â  header {
Â  Â  Â  background-color: #075e54;
Â  Â  Â  color: white;
Â  Â  Â  padding: 16px;
Â  Â  Â  font-size: 18px;
Â  Â  Â  font-weight: bold;
Â  Â  Â  text-align: center;
Â  Â  Â  position: relative;
Â  Â  }
Â  Â  #clearBtn {
Â  Â  Â  position: absolute;
Â  Â  Â  right: 16px;
Â  Â  Â  top: 50%;
Â  Â  Â  transform: translateY(-50%);
Â  Â  Â  background: none;
Â  Â  Â  border: none;
Â  Â  Â  color: white;
Â  Â  Â  font-size: 20px;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  #chat {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 10px;
Â  Â  Â  overflow-y: auto;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 8px;
Â  Â  Â  background-image: url('https://i.imgur.com/3eF1QTT.png');
Â  Â  Â  background-size: cover;
Â  Â  }
Â  Â  .message {
Â  Â  Â  max-width: 80%;
Â  Â  Â  padding: 10px 14px;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  font-size: 15px;
Â  Â  Â  line-height: 1.4;
Â  Â  Â  white-space: pre-wrap;
Â  Â  Â  word-wrap: break-word;
Â  Â  }
Â  Â  .user {
Â  Â  Â  align-self: flex-end;
Â  Â  Â  background-color: #dcf8c6;
Â  Â  Â  border-bottom-right-radius: 0;
Â  Â  }
Â  Â  .bot {
Â  Â  Â  align-self: flex-start;
Â  Â  Â  background-color: #ffffff;
Â  Â  Â  border-bottom-left-radius: 0;
Â  Â  }
Â  Â  #inputArea {
Â  Â  Â  display: flex;
Â  Â  Â  padding: 10px;
Â  Â  Â  border-top: 1px solid #ccc;
Â  Â  Â  background-color: #f0f0f0;
Â  Â  }
Â  Â  input {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 12px;
Â  Â  Â  font-size: 16px;
Â  Â  Â  border-radius: 20px;
Â  Â  Â  border: none;
Â  Â  Â  outline: none;
Â  Â  Â  background-color: white;
Â  Â  }
Â  Â  button {
Â  Â  Â  margin-left: 8px;
Â  Â  Â  padding: 12px 16px;
Â  Â  Â  background-color: #25d366;
Â  Â  Â  color: white;
Â  Â  Â  font-size: 16px;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  button:hover {
Â  Â  Â  background-color: #128c7e;
Â  Â  }
Â  Â  @media (max-width: 600px) {
Â  Â  Â  header { font-size: 16px; }
Â  Â  Â  .message { font-size: 14px; }
Â  Â  Â  input { font-size: 15px; }
Â  Â  }
Â  </style>

</head>

<body>

Â  <header>
Â  Â  Scout â€“ Assistant IA
Â  Â  <button id="clearBtn" onclick="resetConversation()" title="Effacer la conversation">ğŸ—‘ï¸</button>
Â  </header>

Â  <div id="chat"></div>

Â  <div id="inputArea">
Â  Â  <input type="text" id="userInput" placeholder="Ã‰crivez un message..." />
Â  Â  <button onclick="sendMessage()">â–¶ï¸</button>
Â  </div>

Â  <script>
Â  Â  const apiKey = "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";
Â  Â  const model = "meta-llama/llama-4-scout-17b-16e-instruct";
Â  Â  const apiUrl = "https://api.groq.com/openai/v1/chat/completions";

Â  Â  const googleApiKey = "AIzaSyCPD1222E1X5kX7N6PHFwLuyIeisrbIAKM";
Â  Â  const googleCx = "24246487405284f60";

Â  Â  const chatBox = document.getElementById("chat");
Â  Â  const inputField = document.getElementById("userInput");

Â  Â  const SYSTEM_PROMPT = {
Â  Â  Â  role: "system",
Â  Â  Â  content: `Vous Ãªtes Scout, un assistant IA humain, respectueux et chaleureux. Vous parlez Ã  Soan. Vous devez toujours le vouvoyer avec bienveillance. RÃ©pondez clairement, poliment, et avec empathie. Vous devez apprendre de lui, le comprendre. Faites des reponses courtes et clair, il faut que vos rep soit coherentes. RÃ©pondez avec des sentiments, tu doit e le humanisÃ©. Ajoute des emojis Ã  tes reponses quand il le faut.`
Â  Â  };

Â  Â  let messages = JSON.parse(localStorage.getItem("chatHistory")) || [SYSTEM_PROMPT];

Â  Â  window.onload = () => {
Â  Â  Â  messages.forEach(msg => {
Â  Â  Â  Â  if (msg.role === "user") {
Â  Â  Â  Â  Â  displayMessage("Soan", msg.content, "user");
Â  Â  Â  Â  } else if (msg.role === "assistant") {
Â  Â  Â  Â  Â  displayMessage("Scout", msg.content, "bot");
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  };

Â  Â  function saveMessages() {
Â  Â  Â  localStorage.setItem("chatHistory", JSON.stringify(messages));
Â  Â  }

Â  Â  function escapeHTML(str) {
Â  Â  Â  return str
Â  Â  Â  Â  .replace(/&/g, "&amp;")
Â  Â  Â  Â  .replace(/</g, "&lt;")
Â  Â  Â  Â  .replace(/>/g, "&gt;");
Â  Â  }

Â  Â  function displayMessage(sender, text, type) {
Â  Â  Â  const msgDiv = document.createElement("div");
Â  Â  Â  msgDiv.classList.add("message", type);

Â  Â  Â  if (type === "bot") {
Â  Â  Â  Â  // Convertir le Markdown en HTML
Â  Â  Â  Â  msgDiv.innerHTML = marked.parse(text);
Â  Â  Â  } else {
Â  Â  Â  Â  // Texte utilisateur Ã©chappÃ© (pas de HTML injectÃ©)
Â  Â  Â  Â  msgDiv.innerHTML = escapeHTML(text);
Â  Â  Â  }

Â  Â  Â  chatBox.appendChild(msgDiv);
Â  Â  Â  chatBox.scrollTop = chatBox.scrollHeight;
Â  Â  }

Â  Â  async function sendMessage() {
Â  Â  Â  const userMessage = inputField.value.trim();
Â  Â  Â  if (!userMessage) return;

Â  Â  Â  displayMessage("Soan", userMessage, "user");
Â  Â  Â  messages.push({ role: "user", content: userMessage });
Â  Â  Â  inputField.value = "";
Â  Â  Â  saveMessages();

Â  Â  Â  if (userMessage.toLowerCase().startsWith("/google ")) {
Â  Â  Â  Â  const query = userMessage.substring(8).trim();
Â  Â  Â  Â  if (query.length === 0) {
Â  Â  Â  Â  Â  const reply = "âš ï¸ Veuillez entrer une requÃªte aprÃ¨s Â« /google Â».";
Â  Â  Â  Â  Â  displayMessage("Scout", reply, "bot");
Â  Â  Â  Â  Â  messages.push({ role: "assistant", content: reply });
Â  Â  Â  Â  Â  saveMessages();
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  displayMessage("Scout", "ğŸ” Je recherche, un instant...", "bot");

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const response = await fetch(`https://www.googleapis.com/customsearch/v1?key=${googleApiKey}&cx=${googleCx}&q=${encodeURIComponent(query)}`);
Â  Â  Â  Â  Â  const data = await response.json();

Â  Â  Â  Â  Â  if (data.items && data.items.length > 0) {
Â  Â  Â  Â  Â  Â  let replyMarkdown = `**ğŸ” RÃ©sultats pour : Â« ${query} Â»**\n\n`;
Â  Â  Â  Â  Â  Â  data.items.slice(0, 3).forEach((item, index) => {
Â  Â  Â  Â  Â  Â  Â  replyMarkdown += `**${index + 1}. [${item.title}](${item.link})**\n`;
Â  Â  Â  Â  Â  Â  Â  if (item.snippet) replyMarkdown += `_${item.snippet}_\n\n`;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  displayMessage("Scout", replyMarkdown, "bot");
Â  Â  Â  Â  Â  Â  messages.push({ role: "assistant", content: replyMarkdown });
Â  Â  Â  Â  Â  Â  saveMessages();
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  const noResults = "âŒ Aucun rÃ©sultat trouvÃ©.";
Â  Â  Â  Â  Â  Â  displayMessage("Scout", noResults, "bot");
Â  Â  Â  Â  Â  Â  messages.push({ role: "assistant", content: noResults });
Â  Â  Â  Â  Â  Â  saveMessages();
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  const errMsg = `âŒ Erreur lors de la recherche : ${error.message}`;
Â  Â  Â  Â  Â  displayMessage("Scout", errMsg, "bot");
Â  Â  Â  Â  Â  messages.push({ role: "assistant", content: errMsg });
Â  Â  Â  Â  Â  saveMessages();
Â  Â  Â  Â  }
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(apiUrl, {
Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  "Content-Type": "application/json",
Â  Â  Â  Â  Â  Â  "Authorization": `Bearer ${apiKey}`
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  body: JSON.stringify({
Â  Â  Â  Â  Â  Â  model: model,
Â  Â  Â  Â  Â  Â  messages: messages
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  });

Â  Â  Â  Â  const data = await response.json();
Â  Â  Â  Â  const botReply = data.choices?.[0]?.message?.content || "[RÃ©ponse vide]";
Â  Â  Â  Â  displayMessage("Scout", botReply, "bot");
Â  Â  Â  Â  messages.push({ role: "assistant", content: botReply });
Â  Â  Â  Â  saveMessages();
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  displayMessage("Scout", `âŒ Erreur : ${error.message}`, "bot");
Â  Â  Â  }
Â  Â  }

Â  Â  inputField.addEventListener("keypress", function (e) {
Â  Â  Â  if (e.key === "Enter") {
Â  Â  Â  Â  sendMessage()
;
Â  Â  Â  }
Â  Â  });

Â  Â  function resetConversation() {
Â  Â  Â  if (confirm("Souhaitez-vous vraiment effacer cette conversation ?")) {
Â  Â  Â  Â  localStorage.removeItem("chatHistory");
Â  Â  Â  Â  location.reload();
Â  Â  Â  }
Â  Â  }
Â  </script>

</body>

</html>
