<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chat SCP + Formulaire</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet" />
<style>
  /* Reset */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body, html {
    height: 100%;
    font-family: 'Inter', sans-serif;
    background-color: #0f172a;
    color: #f9fafb;
    display: flex;
    flex-direction: column;
  }
  #container {
    flex: 1;
    display: flex;
    flex-direction: column;
    max-width: 900px;
    margin: auto;
    padding: 1rem;
    gap: 1rem;
  }
  header {
    display: flex;
    justify-content: center;
    gap: 2rem;
  }
  header button {
    background: none;
    border: none;
    color: #94a3b8;
    font-weight: 700;
    font-size: 1.1rem;
    padding: 0.6rem 1.2rem;
    border-radius: 12px;
    cursor: pointer;
    transition: color 0.3s ease, background-color 0.3s ease;
  }
  header button.active,
  header button:hover {
    color: #10b981;
    background-color: #1e293b;
  }

  /* Sections (onglets) */
  section {
    display: none;
    flex-direction: column;
    background-color: #1e293b;
    padding: 1.5rem;
    border-radius: 16px;
    box-shadow: 0 0 10px #10b981aa;
  }
  section.active {
    display: flex;
  }
  
  /* ACCUEIL */
  #homeSection h1 {
    font-size: 2.8rem;
    margin-bottom: 0.5rem;
    color: #10b981;
  }
  #homeSection p {
    font-size: 1.2rem;
    line-height: 1.6;
    color: #cbd5e1;
  }

  /* CHAT SCP */
  #chatBox {
    flex: 1;
    overflow-y: auto;
    margin-bottom: 1rem;
    border: 1px solid #334155;
    border-radius: 12px;
    padding: 1rem;
    background-color: #0f172a;
    max-height: 350px;
  }
  .msg {
    margin-bottom: 1rem;
    padding: 0.8rem 1rem;
    border-radius: 14px;
    max-width: 80%;
    white-space: pre-wrap;
  }
  .msg.user {
    background-color: #10b981cc;
    align-self: flex-end;
    color: #0f172a;
    font-weight: 600;
  }
  .msg.assistant {
    background-color: #334155cc;
    color: #cbd5e1;
    align-self: flex-start;
    font-style: italic;
  }
  #chatInputRow {
    display: flex;
    gap: 0.7rem;
  }
  #chatInputRow input {
    flex: 1;
    padding: 0.7rem 1rem;
    border-radius: 12px;
    border: none;
    font-size: 1rem;
    background-color: #1e293b;
    color: #f9fafb;
    outline-offset: 3px;
    box-shadow: inset 0 0 8px #10b981aa;
    transition: box-shadow 0.3s ease;
  }
  #chatInputRow input:focus {
    box-shadow: 0 0 10px #10b981cc;
  }
  #chatInputRow button {
    background-color: #10b981;
    border: none;
    color: #0f172a;
    font-weight: 700;
    padding: 0.7rem 1.4rem;
    border-radius: 12px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  #chatInputRow button:hover {
    background-color: #059669;
  }

  /* FORMULAIRE */
  form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  form label {
    font-weight: 700;
    color: #10b981;
  }
  form input, form select, form textarea {
    padding: 0.8rem 1rem;
    border-radius: 12px;
    border: none;
    background-color: #1e293b;
    color: #f9fafb;
    font-size: 1rem;
    box-shadow: inset 0 0 8px #10b981aa;
    resize: vertical;
  }
  form input:focus, form select:focus, form textarea:focus {
    outline: 3px solid #10b981cc;
  }
  form button {
    background-color: #10b981;
    border: none;
    padding: 1rem;
    border-radius: 14px;
    font-weight: 700;
    font-size: 1.1rem;
    color: #0f172a;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  form button:hover {
    background-color: #059669;
  }
  #applyMsg {
    margin-top: 1rem;
    font-weight: 700;
    color: #34d399;
    display: none;
  }
</style>
</head>
<body>
  <div id="container">
    <header>
      <button id="btnHome" class="active">Accueil</button>
      <button id="btnChat">Chat SCP</button>
      <button id="btnForm">Inscription</button>
    </header>

    <section id="homeSection" class="active">
      <h1>Bienvenue dans l'univers SCP</h1>
      <p>
        Explorez des informations détaillées sur les objets, entités et phénomènes anormaux documentés par la Fondation SCP.  
        Utilisez notre chat IA pour poser toutes vos questions sur SCP et obtenez des réponses précises et rapides.
      </p>
    </section>

    <section id="chatSection">
      <div id="chatBox"></div>
      <div id="chatInputRow">
        <input id="chatInput" type="text" placeholder="Pose ta question sur SCP..." autocomplete="off"/>
        <button id="chatSendBtn">Envoyer</button>
      </div>
    </section>

    <section id="formSection">
      <form id="inscriptionForm">
        <label for="fullName">Nom complet</label>
        <input type="text" id="fullName" name="fullName" placeholder="Votre nom complet" required />

        <label for="email">Adresse Email</label>
        <input type="email" id="email" name="email" placeholder="exemple@mail.com" required />

        <label for="role">Rôle souhaité</label>
        <select id="role" name="role" required>
          <option value="">-- Choisissez un rôle --</option>
          <option value="agent">Agent de terrain</option>
          <option value="chercheur">Chercheur SCP</option>
          <option value="technicien">Technicien</option>
        </select>

        <label for="motivation">Motivation</label>
        <textarea id="motivation" name="motivation" rows="4" placeholder="Pourquoi souhaitez-vous rejoindre la Fondation ?" required></textarea>

        <button type="submit">Soumettre</button>
      </form>
      <div id="applyMsg">Merci pour votre inscription, nous reviendrons vers vous bientôt !</div>
    </section>
  </div>

<script>
  // Gestion onglets
  const btnHome = document.getElementById('btnHome');
  const btnChat = document.getElementById('btnChat');
  const btnForm = document.getElementById('btnForm');

  const homeSection = document.getElementById('homeSection');
  const chatSection = document.getElementById('chatSection');
  const formSection = document.getElementById('formSection');

  function setActive(button, section) {
    [btnHome, btnChat, btnForm].forEach(b => b.classList.remove('active'));
    [homeSection, chatSection, formSection].forEach(s => s.classList.remove('active'));
    button.classList.add('active');
    section.classList.add('active');
  }

  btnHome.addEventListener('click', () => setActive(btnHome, homeSection));
  btnChat.addEventListener('click', () => setActive(btnChat, chatSection));
  btnForm.addEventListener('click', () => setActive(btnForm, formSection));

  // Chat SCP simple simulation (à remplacer par vrai API plus tard)
  const chatBox = document.getElementById('chatBox');
  const chatInput = document.getElementById('chatInput');
  const chatSendBtn = document.getElementById('chatSendBtn');

  function addMessage(text, sender) {
    const msgDiv = document.createElement('div');
    msgDiv.classList.add('msg', sender);
    msgDiv.textContent = text;
    chatBox.appendChild(msgDiv);
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  chatSendBtn.addEventListener('click', () => {
    const msg = chatInput.value.trim();
    if(!msg) return;
    addMessage(msg, 'user');
    chatInput.value = '';
    // Simuler réponse IA SCP (en attendant API)
    setTimeout(() => {
      addMessage("Réponse SCP IA : " + msg.split('').reverse().join(''), 'assistant');
    }, 1000);
  });
  chatInput.addEventListener('keydown', (e) => {
    if(e.key === 'Enter') {
      e.preventDefault();
      chatSendBtn.click();
    }
  });

  // Formulaire + API GROQ post
  const form = document.getElementById('inscriptionForm');
  const applyMsg = document.getElementById('applyMsg');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    applyMsg.style.display = 'none';

    const data = {
      _type: 'inscription',
      fullName: form.fullName.value.trim(),
      email: form.email.value.trim(),
      role: form.role.value,
      motivation: form.motivation.value.trim(),
      date: new Date().toISOString()
    };

    try {
      const res = await fetch('https://your-groq-api-endpoint/v1/data/mutate/your-dataset', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: 'Bearer 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'
        },
        body: JSON.stringify({
          mutations: [
            { create: data }
          ]
        }),
      });

      if (!res.ok) throw new Error('Erreur lors de l\'envoi');

      applyMsg.style.display = 'block';
      form.reset();

    } catch (error) {
      alert('Erreur lors de la soumission : ' + error.message);
    }
  });
</script>
</body>
</html>
